<h1>{{ survey.name }}</h1>
<div class="row-fluid">
    <div class="span4">
        <div class="well">
            <h2>{{ survey.survey_responses |number}} surveys taken</h2>
            <ul class="unstyled">
                <li><strong>{{ survey.completes |number}}</strong> complete ({{(survey.completes/survey.survey_responses)*100 |number:2}}%)</li>
                <li><strong>{{ survey.survey_responses - survey.completes | number}}</strong> incomplete ({{((survey.survey_responses - survey.completes)/survey.survey_responses) * 100|number:2}}%)</li>
            </ul>
            <ul class="unstyled">
                <li><strong>{{ survey.activity_points | number }}</strong> activity points</li>
                <li><strong>{{ survey.activity_points / survey.completes |number:2 }}</strong> activity points per survey</li>
            </ul>
        </div>
    </div>
    <div class="span8">
        <!-- <div class="row-fluid">
            <div heatmap question="question.slug"></div>
        </div> -->
        <div class="row-fluid" ng-repeat="question in survey.questions">
            <div  ui-if="question.visualize">
                <div class="pull-right" ng-repeat="filterQuestion in question.filterQuestions">
                    <select placeholder="filter by {{ filterQuestion.slug }}" multiple=true ng-model="question.filters[filterQuestion.slug]" ui-select2 style="width: 200px">
                        <option value="{{answer.answer}}" ng-repeat="answer in filterQuestion.answer_domain">
                            <strong>{{answer.answer}}</strong>
                        </option>
                    </select>
                </div>
                <div ng-switch on="question.report_type">    
                    <div ng-switch-when="heatmap">
                        <div class="row-fluid">
                            <div class="pull-right">
                                <select style="width: 200px" ng-model="question.selectedFilter">
                                    <option value="">all activities</option>
                                    <option ng-repeat="filterItem in question.filterItems" value="{{filterItem}}">{{filterItem}}</option>
                                </select>
                            </div>
                        </div>
                        <div heatmap question="question" filteritems="question.filterItems" class="heatmap"></div>
                    </div>
                    <div ng-switch-when="distribution">
                        <h4>
                            Distribution by {{ question.slug }}
                            <dl ng-repeat="(slug, filter) in question.filters">
                                <dt>{{ slug }}:</dt>                           
                                <dd ng-show="filter.length" ng-repeat="filterItem in filter">{{filterItem}}</dd>
                                <dd ng-hide="filter.length">all</dd>
                            </dl>
                        </h4>

                        <distribution filter="question.filters" question="question" survey-slug="survey.slug"></distribution>
                    </div>
                </div>            
            </div>
        </div>
    </div>
</div>
